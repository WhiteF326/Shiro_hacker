<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="https://unpkg.com/sakura.css/css/sakura.css" type="text/css">
  <link rel="shortcut icon" href="materials/1LTxsErZ_400x400.ico" id="fav">
  <title>Shiro_hacker</title>
</head>

<style>
  input{
    transition-duration: 1s;
    transition-property: background;
  }
</style>

<body>

  <script type="module">
    // import ky from "./modules//ky.js";
    import { fetchJSON } from "https://js.sabae.cc/fetchJSON.js";

    function makeDate(dayString) {
      const retobj = new Date();
      retobj.setUTCFullYear(parseInt(dayString.split(" ")[0].split("-")[0]));
      retobj.setUTCMonth(parseInt(dayString.split(" ")[0].split("-")[1]) - 1);
      retobj.setUTCDate(parseInt(dayString.split(" ")[0].split("-")[2]));
      retobj.setUTCHours(parseInt(dayString.split(" ")[1].split(":")[0]));
      retobj.setUTCMinutes(parseInt(dayString.split(" ")[1].split(":")[1]));
      retobj.setUTCSeconds(parseInt(dayString.split(" ")[1].split(":")[2]));
      return retobj
    }

    window.onload = async () => {
      // ログイン

      document.getElementById("sendPrm").addEventListener("click", async () => {
        // 入力情報を問い合わせる
        const tryLogin = await fetchJSON(
          "api/user/search",
          {
            id: document.getElementById("userId").value,
            pass: document.getElementById("password").value
          }
        );
        if(tryLogin){
          localStorage.setItem("userId", tryLogin.userId);
          localStorage.setItem("password", tryLogin.password);
          window.location = "index.html";
        }else{
          document.getElementById("cautionPlace").innerHTML = "ユーザーIDまたはパスワードが異なります。<br>"
        }
      });
    }

    // ページ遷移
    function moveTo(url, prm) {
      const contestForm = document.getElementById(url);
      for (let key in prm) document.getElementById(key).setAttribute("value", prm[key]);
      contestForm.submit();
    }
  </script>

  <span>
    <span style="display: inline-block;">
      <h6>Everyone to be enforced.</h6>
      <h3><a href="index.html">Shiro_hacker</a></h3>
    </span>
    <span style="display: inline-block; width: 20%;"></span>
    <span style="display: inline-block;">
      <p>Contact: <a href="mailto:lume1a326.leno@gmail.com">lume1a326.leno@gmail.com</a></p>
      <p>Twitter: <a href="https://twitter.com/shiroha_F14" target="_blank">@shiroha_F14</a></p>
    </span>
  </span>
  <hr>
  <!-- <video src="materials/Banner.mp4" autoplay loop></video> -->
  <div style="display: block; margin-top: 20px;">
    <span>
      <h2 style="display: inline;">ログイン</h2>
    </span>
  </div>
  <br>
  <div>
    <span>
      <input type="text" id="userId" placeholder="ユーザーID">
      ※4文字以上<br>
      <input type="text" id="password" placeholder="パスワード">
      ※8文字以上、半角英数字のみ<br>
      <span id="cautionPlace"></span>
      <button id="sendPrm">ログイン</button>
    </span>
  </div>

</body>

<script>
    //
</script>

</html>